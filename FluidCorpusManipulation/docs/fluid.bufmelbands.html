<!--
Part of the Fluid Corpus Manipulation Project (http://www.flucoma.org/)
Copyright 2017-2019 University of Huddersfield.
Licensed under the BSD-3 License.
See license.md file in the project root for full license information.
This project has received funding from the European Research Council (ERC)
under the European Unionâ€™s Horizon 2020 research and innovation programme
(grant agreement No 725899).
-->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./_c74_common.css">
<title>fluid.bufmelbands Reference</title>
<style>
	* {
		font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		--blue: rgb(80,164,252);
		--dark-blue: #204265;
	}

	body {
		padding: 1em;
	}

	h1 {
		text-decoration: underline;
		background-color: var(--blue);
		color: white;
		padding: 0.25em;
		margin: 0;
	}
	h2 {
		border-bottom: 0.5px solid rgba(128, 128, 128, 0.513);
	}

	a {
		color: var(--blue);
	}

	a:hover {
		background-color: var(--blue);
		color: white;
	}
	
	.type, .defaultval { 
		font-weight: normal; 
  }
</style> 
</head>
<body>
  <h1 class="ref_title">fluid.bufmelbands</h1>
  <div class="digest">A Perceptually Spread Spectral Contour Descriptor on a Buffer</div>
  <section class="object_description">
    <h2>Description</h2> 
    
    <p>Magnitudes for a number of perceptually-evenly spaced bands.</p>

    
  </section> 
  <section class="object_discussion"> 
    <h2>Discussion</h2> 
    
    <p><a href="fluid.bufmelbands.html">fluid.bufmelbands</a> returns a Mel-Frequency Spectrum containing the user-defined <code>numbands</code>. The Mel-Frequency Spectrum is a histogram of FFT bins bundled according to their relationship to the Mel scale ( <a class="reference external" href="https://en.wikipedia.org/wiki/Mel_scale">https://en.wikipedia.org/wiki/Mel_scale</a> ) which represents frequency space logarithmically, mimicking how humans perceive pitch distance. The name &quot;Mel&quot; derives from the word &quot;melody&quot;. The Hz-to-Mel conversion used by <a href="fluid.bufmelbands.html">fluid.bufmelbands</a> is <code>mel = 1127.01048 * log(hz / 700.0 + 1.0)</code>.</p>
<p>This implementation allows selection of the range and number of bands dynamically. The <code>numbands</code> MelBands will be perceptually equally distributed between <code>minfreq</code> and <code>maxfreq</code>.</p>
<p>When using a high value for <code>numbands</code>, you may end up with empty channels (filled with zeros) in the MelBands output. This is because there is not enough information in the FFT analysis to properly calculate values for every MelBand. Increasing the <code>fftsize</code> will ensure you have values for all the MelBands.</p>
<p>Visit <a class="reference external" href="https://learn.flucoma.org/reference/melbands">https://learn.flucoma.org/reference/melbands</a> to learn more.</p>


    <p>Read more about fluid.bufmelbands on the <a href='https://learn.flucoma.org/reference/melbands'>learn platform</a>.</p>
    
    <p>fluid.bufmelbands is part of the Fluid Decomposition Toolkit of the FluCoMa project. For more explanations, learning material, and discussions on its musicianly uses, visit <a href="http://www.flucoma.org/">flucoma.org</a>.</p>
  </section>
  <section class="argument_section">
    <h2>Arguments</h2><h3 class="argument_name">Number of Bands<span class="type"> [number]</span></h3> 
      <div class="optional">Optional</div><span class="defaultval"> (default: 40)</span><div class="description"><p>Shorthand argument for <code>numbands</code></p>
</div>
      <!--  --></section> 
  <section class="attribute_section">
    <h2>Attributes</h2><div class="attribute_group">
      <h3 class="attribute_name">features
        <span class="type"> [symbol]</span>
        <span class="defaultval"> (default: None)</span>
      </h3>
      <div class="description"><p>The buffer to write the MelBands magnitudes into.</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">fftsettings
        <span class="type"> [int]</span>
        <span class="defaultval"> (default: [[&#39;winSize&#39;, 1024], [&#39;hopSize&#39;, -1], [&#39;fftSize&#39;, -1]])</span>
      </h3>
      <div class="description"><p>FFT settings consist of three numbers representing the window size, hop size and FFT size in samples:</p>
<p>The hop size and fft size can both be set to -1 (and are by default), with slightly different meanings:</p>
<ul class="simple">
<li>For the hop size, -1 = <code>windowsize/2</code></li>
<li>For the FFT size, -1 = <code>windowsize</code> snapped to the nearest equal / greater power of 2 (e.g. <code>windowsize 1024</code> =&gt; <code>fftsize 1024</code>, but <code>windowssize 1000</code> also =&gt; <code>fftsize 1024</code>)</li>
</ul>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>FFTSize, if != -1, will snap to the next greatest power of two &amp;gt; 4</li>
<li>The maximum FFT size is limited to the value of the <code>maxfftsize</code> argument</li>
<li>if FFT size != -1, then window size is clipped at FFT size</li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">maxfreq
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 20000.0)</span>
      </h3>
      <div class="description"><p>The upper bound of the frequency band to use in analysis, in Hz. The default is 20000.</p>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>Minimum: <code>0</code></li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">maxfftsize
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: -1)</span>
      </h3>
      <div class="description"><p>Set an explicit upper bound on the FFT size at object instantiation. The default of -1 sets this to whatever the initial FFT size is</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">maxnumbands
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: -1)</span>
      </h3>
      <div class="description"><p>Manually sets a maximum value for <code>numbands</code>. Can only be set at object instantiation. The default of -1 sets this equal to the initial value of <code>numbands</code></p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">minfreq
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 20.0)</span>
      </h3>
      <div class="description"><p>The lower bound of the frequency band to use in analysis, in Hz. The default is 20.</p>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>Minimum: <code>0</code></li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">normalize
        <span class="type"> [int]</span>
        <span class="defaultval"> (default: 1)</span>
      </h3>
      <div class="description"><p>This flag indicates whether to use normalized triangle filters, which account for the number of FFT magnitudes used to calculate the MelBands. When normalization is off (<cite>normalize</cite> = 0) the higher MelBands tend to be disproportionately large because they are summing more FFT magnitudes. The default is to have normalization on (<cite>normalize</cite> = 1).</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">numbands
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 40)</span>
      </h3>
      <div class="description"><p>The number of bands that will be returned. This determines how many channels are in the <code>features</code> buffer (<code>numbands</code> * <code>numchans</code>). The default is 40.</p>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>Minimum: <code>2</code></li>
<li>Maximum: <code>maxnumbands</code></li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">numchans
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: -1)</span>
      </h3>
      <div class="description"><p>For multichannel <code>source</code>, how many channels should be processed, starting from <code>startchan</code> and counting up. The default of -1 indicates to analyse through the last channel in the <code>source</code>.</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">numframes
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: -1)</span>
      </h3>
      <div class="description"><p>How many frames should be analysed, in samples. The default of -1 indicates to analyse to the end of the buffer.</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">padding
        <span class="type"> [int]</span>
        <span class="defaultval"> (default: 1)</span>
      </h3>
      <div class="description"><p>Controls the zero-padding added to either end of the source buffer or segment. Padding ensures all values are analysed. Possible values are:</p>
</div><div class="enumvals">      
      <ol start='0'><li>
          <p>No padding - The first analysis window starts at time 0, and the samples at either end will be tapered by the STFT windowing function.</p>

        </li><li>
          <p>Half the window size - The first sample is centred in the analysis window ensuring that the start and end of the segment are accounted for in the analysis.</p>

        </li><li>
          <p>Window size minus the hop size - Mode 2 can be useful when the overlap factor (window size / hop size) is greater than 2, to ensure that the input samples at either end of the segment are covered by the same number of analysis frames as the rest of the analysed material.</p>

        </li></ol>
      </div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">scale
        <span class="type"> [int]</span>
        <span class="defaultval"> (default: 0)</span>
      </h3>
      <div class="description"><p>This flag sets the scaling of the output value. It is either linear (0, by default) or in dB (1).</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">source
        <span class="type"> [symbol]</span>
        <span class="defaultval"> (default: None)</span>
      </h3>
      <div class="description"><p>The buffer to use as the source material to be analysed. The different channels of multichannel buffers will be processed sequentially.</p>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">startchan
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 0)</span>
      </h3>
      <div class="description"><p>For a multichannel <code>source</code>, which channel to begin analysis from. The default is 0.</p>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>Minimum: <code>0</code></li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">startframe
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 0)</span>
      </h3>
      <div class="description"><p>Where in the <code>source</code> to begin the analysis, in samples. The default is 0.</p>
<p><strong>Constraints</strong></p>
<ul class="simple">
<li>Minimum: <code>0</code></li>
</ul>
</div><!--  -->
    </div><div class="attribute_group">
      <h3 class="attribute_name">warnings
        <span class="type"> [number]</span>
        <span class="defaultval"> (default: 0)</span>
      </h3>
      <div class="description"><p>Enable warnings to be issued whenever a parameter value is constrained (e.g. clipped)</p>
</div><!--  -->
    </div></section> 
  <section class="method_section"> 
    <h2>Messages</h2><div class="method_group">
      <h3 class="method_name" name="bang">bang</h3>
      <div class="description"> A bang will commence processing on object given its current settings, unless it is already busy. In that case, the behaviour depends on the value of the <span class="messagename" data-message="queue"> queue </span>
        attribute. </div>
    </div>
    <div class="method_group">
      <h3 class="method_name" name="cancel">cancel</h3>
      <div class="description"> When processing in non-blocking mode, this will cancel the job underway, without updating destination buffers. </div>
    </div><div class="method_group">
      <h3 class="method_name" name="reset">reset</h3>
      <div class="description"> Calling <span class="messagename" data-message="reset"> reset </span> will change parameter values back to those the object was <em> created </em> with, i.e. any attribute values set in the box will be retained </div>
    </div>
  </section> 
  <section class="seealso"> 
    <h2>See Also</h2><h3 class="seealso_name"><a href="fluid.melbands~.html">MelBands</a></h3><h3 class="seealso_name"><a href="fluid.bufpitch.html">BufPitch</a></h3><h3 class="seealso_name"><a href="fluid.bufloudness.html">BufLoudness</a></h3><h3 class="seealso_name"><a href="fluid.bufmfcc.html">BufMFCC</a></h3><h3 class="seealso_name"><a href="fluid.bufspectralshape.html">BufSpectralShape</a></h3><h3 class="seealso_name"><a href="fluid.bufstats.html">BufStats</a></h3></section> 
</body>
</html>